@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

@using X.PagedList.Mvc.Core;
@using X.PagedList;
@using X.PagedList.Mvc.Core.Common;

@model IPagedList<Manage.Web.ViewModels.AppUserViewModel>

<section class="content">
    <div class="container-fluid">

        <div class="card card-default">
            <div class="card-header">
                <h3 class="card-title">My Leave List</h3>
            </div>
            <!-- /.card-header -->
            <div class="card-body">
                <div class="row data-table">
                    <div class="card-table table-responsive-lg  ">
                        <table class="table fitwidth table-hover   table-responsive-lg " style="display:table">
                            <thead>
                                <tr>
                                    <th>Employee</th>
                                    <th>From Date</th>
                                    <th>Till Date</th>
                                    <th>Leave Type</th>
                                    <th>Number of Days</th>
                                    <th>Reason</th>
                                    <th>Status</th>
                                    <th>Leave Details</th>
                                    <th>Edit</th>
                                    <th>Delete</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var employee in Model)
                                {

                                    DateTime end = employee.TillDate;
                                    DateTime start = employee.FromDate;

                                    double numberOfDaysofLeave;

                                    if (employee.Duration == "First Half Day" || employee.Duration == "Second Half Day")
                                    {
                                        numberOfDaysofLeave = (end - start).Days + 0.5;
                                    }
                                    else
                                    {
                                        numberOfDaysofLeave = (end - start).Days + 1;
                                    }
                                    <tr>
                                        <td>@employee.FullName</td>
                                        <td>@employee.FromDate.ToString("dd/MM/yyyy")</td>
                                        <td>@employee.TillDate.ToString("dd/MM/yyyy")</td>
                                        <td>@employee.LeaveType</td>

                                        <td>@numberOfDaysofLeave</td>
                                        <td>@employee.Reason</td>
                                        <td>@employee.Status</td>
                                        <td><a asp-action="MyLeaveDetails" asp-controller="Leave" asp-route-leaveid="@employee.LeaveId">Leave Details</a> </td>
                                        <td><a asp-action="EditMyLeave" class="btn btn-outline-info" asp-controller="Home" asp-route-leaveid="@employee.LeaveId"><i class="fas fa-edit"></i></a></td>
                                        <td>
                                            <form method="post" asp-action="DeleteMyLeave" asp-route-leaveId="@employee.LeaveId">
                                                <span id="confirmDeleteSpan_@employee.LeaveId" style="display:none">
                                                    Are you sure you want to delete
                                                    <button type="submit" class="btn btn-outline-secondary">Yes</button>
                                                    <a href="#" class="btn btn-outline-primary" onclick="confirmDelete('@employee.LeaveId' ,false)">No</a>
                                                </span>
                                                <span id="deleteSpan_@employee.LeaveId">
                                                    <a href="#" class="btn btn-outline-danger" onclick="confirmDelete('@employee.LeaveId', true)">
                                                        <i class="fas fa-trash"></i>
                                                    </a>
                                                </span>
                                            </form>
                                        </td>
                                    </tr>

                                }

                            </tbody>
                        </table>
                    </div>
                </div>

                <br />
                Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount
                @Html.PagedListPager(Model, page => Url.Action("GetAllMyLeaves", new { page }), new PagedListRenderOptions
                {
                    DisplayLinkToIndividualPages = true,
                    DisplayPageCountAndCurrentLocation = false,
                    MaximumPageNumbersToDisplay = 10,
                    LiElementClasses = new string[] { "page-item" },
                    PageClasses = new string[] { "page-link" },

                })
            </div>
        </div>
    </div>
</section>
